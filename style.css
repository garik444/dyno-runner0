const dino = document.getElementById("dino");
const game = document.querySelector(".game");
const scoreDisplay = document.getElementById("score");

let score = 0;
let isJumping = false;
let isGameOver = false;

// Jump when spacebar is pressed
document.addEventListener("keydown", function (event) {
  if (event.code === "Space") {
    jump();
  }
});

function jump() {
  if (isJumping) return;
  isJumping = true;
  dino.classList.add("jump");
  setTimeout(() => {
    dino.classList.remove("jump");
    isJumping = false;
  }, 500);
}

// Spawn cacti at random intervals
function createCactus() {
  const cactus = document.createElement("div");
  cactus.classList.add("cactus");
  game.appendChild(cactus);

  let cactusPosition = 600;
  let randomTime = Math.random() * 2000 + 1000; // 1â€“3 seconds

  let moveInterval = setInterval(() => {
    if (isGameOver) {
      clearInterval(moveInterval);
      cactus.remove();
      return;
    }

    cactusPosition -= 5;
    cactus.style.left = cactusPosition + "px";

    let dinoTop = parseInt(window.getComputedStyle(dino).getPropertyValue("bottom"));

    // Collision detection
    if (cactusPosition > 40 && cactusPosition < 90 && dinoTop < 40) {
      isGameOver = true;
      scoreDisplay.textContent = "Game Over! Final Score: " + score;
      clearInterval(moveInterval);
      document.querySelectorAll(".cactus").forEach(c => c.remove());
    }

    // Remove off-screen cactus
    if (cactusPosition < -30) {
      clearInterval(moveInterval);
      cactus.remove();
    }
  }, 20);

  // Spawn next cactus
  if (!isGameOver) setTimeout(createCactus, randomTime);
}

// Increase score
function updateScore() {
  if (!isGameOver) {
    score++;
    scoreDisplay.textContent = "Score: " + score;
    setTimeout(updateScore, 200);
  }
}

// Start game
createCactus();
updateScore();
